---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';

export async function getStaticPaths() {
	const news = await getCollection('news');
	return news.map((entry) => ({
		params: { slug: entry.slug },
		props: { entry },
	}));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const { title, description, pubDate, image } = entry.data;
const formattedDate = new Intl.DateTimeFormat('ru-RU', {
	year: 'numeric',
	month: 'long',
	day: 'numeric'
}).format(pubDate);
---

<BaseLayout title={`${title} - ISP Provider`} description={description}>
	<Header />
	
	<main>
		<article class="py-16 md:py-24">
			<div class="container mx-auto px-4 md:px-8 max-w-7xl">
				<div class="max-w-3xl mx-auto mb-12">
					<a href="/news" class="inline-block text-[#4a9eff] no-underline mb-4 transition-colors hover:text-[#357abd]">← Назад к новостям</a>
					<div class="text-gray-600 dark:text-gray-400 text-sm mb-4">{formattedDate}</div>
					<h1 class="text-4xl md:text-5xl mb-8 text-[#1a1a2e] dark:text-white leading-tight">{title}</h1>
					<div class="w-full h-64 md:h-96 overflow-hidden rounded-lg mb-8">
						{image ? (
							<img src={image} alt={title} class="w-full h-full object-cover" />
						) : (
							<div class="w-full h-full flex items-center justify-center bg-gradient-to-br from-[#4a9eff] to-[#357abd]">
								<span class="text-white text-3xl font-bold opacity-80">Новости</span>
							</div>
						)}
					</div>
				</div>
				<div class="max-w-3xl mx-auto leading-relaxed text-gray-800 dark:text-gray-200 prose prose-lg prose-headings:text-[#1a1a2e] dark:prose-headings:text-white prose-a:text-[#4a9eff] prose-a:no-underline hover:prose-a:underline">
					<Content />
				</div>
			</div>
		</article>
	</main>

	<Footer />
</BaseLayout>

<style>
	:global(.prose h2) {
		font-size: 2rem;
		margin-top: 2rem;
		margin-bottom: 1rem;
	}

	:global(.prose h3) {
		font-size: 1.5rem;
		margin-top: 1.5rem;
		margin-bottom: 0.75rem;
	}

	:global(.prose p) {
		margin-bottom: 1.5rem;
	}

	:global(.prose ul),
	:global(.prose ol) {
		margin-bottom: 1.5rem;
		padding-left: 2rem;
	}

	:global(.prose li) {
		margin-bottom: 0.5rem;
	}
</style>
